<!--
  @description       : Upload files to sf db. Display those files in a datatable with delete functionality
  @author            : mateo navarrete
  @group             : BizOps
  @last modified on  : 12-20-2020
  @last modified by  : mateo navarrete
  Modifications Log 
  Ver   Date         Author            Modification
  1.0   12-14-2020   mateo navarrete   Initial Version
-->
<template>
  <div class="" style="border: none; position: relative">
    <!-- START: SPINNER -->
    <template if:true={showLoadingSpinner}>
      <lightning-spinner
        alternative-text="Loading..."
        size="small"
        variant="brand"
      ></lightning-spinner>
    </template>
    <!-- END: SPINNER | START: FILE UPLOADER -->
    <div class={flexipageRegionWidth}>
      <lightning-file-upload
        accept={acceptedFormats}
        disabled={deactivateFileUploader}
        label={label}
        multiple={multipleFiles}
        name="customFileUploader"
        onuploadfinished={handleOnUploadFinished}
        record-id={recordId}
        title={title}
      >
      </lightning-file-upload>
      <!-- END: FILE UPLOADER | START: DATATABLE -->
      <template if:true={showUploadedFiles}>
        <lightning-card>
          <table
            class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_striped"
          >
            <thead>
              <tr class="slds-line-height_reset">
                <th scope="col">
                  <div title="Uploaded">Uploaded</div>
                </th>
                <th scope="col">
                  <div title="File Name">File Name</div>
                </th>
                <th scope="col">
                  <div title="Type">Type</div>
                </th>
                <th scope="col">
                  <div title="Remove">Remove</div>
                </th>
              </tr>
            </thead>
            <tbody>
              <template for:each={uploadedFiles} for:item="file">
                <tr class="slds-hint-parent" key={file.documentId}>
                  <th data-label="Uploaded" scope="row">
                    <div title="success">
                      <lightning-icon
                        alternative-text="success"
                        icon-name="utility:success"
                        size="small"
                        variant="success"
                      ></lightning-icon>
                    </div>
                  </th>
                  <td data-label="File Name">
                    <div title={file.name}>{file.name}</div>
                  </td>
                  <td data-label="Type">
                    <div title={file.ext}>
                      <lightning-icon
                        alternative-text={file.ext}
                        icon-name={file.icon}
                        size="small"
                      ></lightning-icon>
                    </div>
                  </td>
                  <td data-label="Remove">
                    <div title="remove">
                      <lightning-button-icon
                        alternative-text="Delete"
                        icon-name="utility:delete"
                        name="delete"
                        onclick={handleClick}
                        size="small"
                        title="delete"
                        value={file.documentId}
                        variant="border-filled"
                      ></lightning-button-icon>
                    </div>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
        </lightning-card>
      </template>
      <!-- END: DATATABLE | START: MODAL -->
      <template if:true={showModal}>
        <lightning-card>
          <div class="slds-container_small">
            <section
              role="dialog"
              tabindex="-1"
              aria-labelledby="modal-heading"
              aria-modal="true"
              aria-describedby="modal-content"
              class="slds-modal slds-fade-in-open"
            >
              <div class="slds-modal__container">
                <header class="slds-modal__header">
                  <h2
                    id="modal-heading"
                    class="slds-text-heading_medium slds-hyphenate"
                  >
                    Delete File
                  </h2>
                </header>
                <div
                  class="slds-modal__content slds-p-around_medium slds-text-align--center"
                  id="modal-content"
                >
                  <p>Are you sure you want to delete this file?</p>
                </div>
                <footer class="slds-modal__footer">
                  <lightning-button
                    class="slds-m-left_xx-small"
                    label="Cancel"
                    name="cancel"
                    onclick={handleClick}
                    title="Cancel"
                    variant="neutral"
                  ></lightning-button>
                  <lightning-button
                    class="slds-m-left_xx-small"
                    label="Delete"
                    name="confirm"
                    onclick={handleClick}
                    title="Delete"
                    variant="destructive"
                  ></lightning-button>
                </footer>
              </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
          </div>
        </lightning-card>
      </template>
      <!-- END: MODAL -->
    </div>
  </div>
</template>
